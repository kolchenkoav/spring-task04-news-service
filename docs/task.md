[README](../README.md)
## 4.10 Практическая работа
### Цель практической работы
Закрепить знания, полученные по следующим темам:

* Разработка REST API с использованием Spring MVC.  
* Валидация входящих запросов от клиентов.  
* AOP.  
* Создание слоя приложения для работы с базой данных с использованием Spring Boot Data JPA.
* Написание спецификаций для фильтрации новостей при запросе.
* Маппинг сущностей с использованием MapStruct.


### Что нужно сделать
Реализуйте REST API для новостного сервиса. API должен предоставлять возможность:

* создавать пользователей и управлять ими,
* создавать категории новостей и управлять ими,
* создавать новости и управлять ими,
* создавать комментарии для новостей и управлять ими.

### Описание логики работы сервиса
1. Редактирование и удаление новости разрешается только тому пользователю, который её создал. Реализуйте эту логику через AOP.
2. Редактирование и удаление комментария к новости разрешается только тому пользователю, который его создал. Реализуйте эту логику через AOP.
3. Возврат списка сущностей (findAll) должен происходить только с помощью пагинации. Исключение — список комментариев. В API список комментариев должен возвращаться только для конкретной новости.
4. При возврате списка новостей ответ не должен содержать списка комментариев к каждой новости. Вместо этого убедитесь, что каждый объект из списка содержит значение, отображающее количество комментариев.
5. Если возвращается одна новость (findById), она должна содержать все комментарии к ней.
6. Используйте MapStruct для преобразования тела запроса в сущность, с помощью которой можно работать с базой данных (например, сохранить преобразованную сущность). Все тела ответа необходимо преобразовывать в DTO.
7. Реализуйте фильтрацию новостей по категориям и авторам.
8. Настройте корректную обработку ошибок, которые могут произойти в приложении. В случае возникновения ошибки необходимо отдавать клиенту читаемый результат.
9. Реализуйте валидацию входящих данных от клиента.


### Советы и рекомендации
* Вы можете реализовать аспект, который будет выполняться перед методом, помеченным вашей аннотацией. Например, @Before("@annotation(myAnnotation)") означает, что этот аспект будет выполняться перед методом, который помечен аннотацией myAnnotation.
* Вы можете получить HttpServletRequest за пределами контроллера, используя контекст:
RequestAttributes requestAttributes = RequestContextHolder.getRequestAttributes();
HttpServletRequest request = ((ServletRequestAttributes) requestAttributes).getRequest();
С помощью этого объекта вы можете извлечь переменные пути запроса:
var pathVariables = (Map<String, String>) request.getAttribute(HandlerMapping.URI_TEMPLATE_VARIABLES_ATTRIBUTE);
* Также вы можете извлечь и GET-параметры запроса:
request.getParameter(“paramName”)
* Постарайтесь избегать написания какой-либо логики в контроллерах. Используйте их только для вызова сервисных методов и преобразования данных.
* Чтобы реализовать фильтрацию, используйте спецификации.
## Что оценивается
* Гибкость вашего API. Возможность его быстрого изменения/расширения.
* Разделение приложения на слои.
* Соблюдение модели зрелости REST.
* Логические связи между сущностями в базе данных.
* Возвращаемые коды ответов при работе с API.